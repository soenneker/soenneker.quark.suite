@page "/forms/numericedit-demo"

<PageTitle>NumericEdit - Quark Suite</PageTitle>

<Div Class="space-y-8 max-w-4xl">
    <Div Class="space-y-6">
<DemoSection Title="Binding test" Description="Type in the fields below or click 'Load Test Data' to verify binding works." Code="@(@"<NumericEdit Id=""testNumeric1"" Placeholder=""Enter a number..."" @bind-Value=""_testNumeric1""/>
<NumericEdit Id=""testNumeric2"" @bind-Value=""_testNumeric2""/>")">
    <Div Class="p-4 rounded-lg border border-border bg-muted/30 space-y-4">
        <Field>
            <FieldLabel For="testNumeric1">Test Numeric 1:</FieldLabel>
            <FieldBody>
                <NumericEdit Id="testNumeric1"
                             Placeholder="Enter a number..."
                             @bind-Value="_testNumeric1"/>
                <Div Margin="Margin.Is2.FromTop" Padding="Padding.Is2" Class="rounded border border-border bg-background">
                    <Strong>Bound Value:</Strong> <Code>@(_testNumeric1?.ToString() ?? "(empty)")</Code>
                </Div>
            </FieldBody>
        </Field>

        <Field>
            <FieldLabel For="testNumeric2">Test Numeric 2 (Pre-populated with 42.5):</FieldLabel>
            <FieldBody>
                <NumericEdit Id="testNumeric2"
                             Placeholder="Enter a number..."
                             @bind-Value="_testNumeric2"/>
                <Div Margin="Margin.Is2.FromTop" Padding="Padding.Is2" Class="rounded border border-border bg-background">
                    <Strong>Bound Value:</Strong> <Code>@(_testNumeric2?.ToString() ?? "(empty)")</Code>
                </Div>
            </FieldBody>
        </Field>

        <Div Class="flex flex-wrap gap-2 mt-4">
            <Button Class="bg-primary text-primary-foreground" OnClick="LoadNumericTestData">Load Test Data</Button>
            <Button Class="bg-secondary text-secondary-foreground" OnClick="ClearNumericTestData">Clear Test Data</Button>
            <Button Class="bg-muted text-muted-foreground" OnClick="UpdateNumericTestData">Update to Random Values</Button>
        </Div>

        <Div Class="mt-4 p-3 rounded-lg border border-border bg-muted/30">
            <H4 Class="text-sm font-semibold">Test Results:</H4>
            <UnorderedList Margin="Margin.Is0.FromBottom">
                <UnorderedListItem>
                    <Strong>Numeric 1:</Strong> @(_testNumeric1?.ToString() ?? "(not set)")
                </UnorderedListItem>
                <UnorderedListItem>
                    <Strong>Numeric 2:</Strong> @(_testNumeric2?.ToString() ?? "(not set)")
                </UnorderedListItem>
            </UnorderedList>
        </Div>
    </Div>
</DemoSection>

    <Hr/>

    <DemoSection Title="Basic NumericEdit" Description="Numeric input with bind-Value." Code="@(@"<Field>
    <FieldLabel For=""basicNumeric"">Basic Numeric Input</FieldLabel>
    <FieldBody>
        <NumericEdit Id=""basicNumeric"" Placeholder=""Enter a number..."" @bind-Value=""_basicValue""/>
    </FieldBody>
</Field>
<NumericEdit Id=""decimalNumeric"" Placeholder=""Enter a decimal..."" @bind-Value=""_decimalValue""/>")">
        <Field>
            <FieldLabel For="basicNumeric">Basic Numeric Input</FieldLabel>
            <FieldBody>
                <NumericEdit Id="basicNumeric" Placeholder="Enter a number..." @bind-Value="_basicValue"/>
                <Small Class="form-text" TextColor="TextColor.Muted">Current value: @_basicValue</Small>
            </FieldBody>
        </Field>
        <Field>
            <FieldLabel For="decimalNumeric">Decimal Input</FieldLabel>
            <FieldBody>
                <NumericEdit Id="decimalNumeric" Placeholder="Enter a decimal number..." @bind-Value="_decimalValue"/>
                <Small Class="form-text" TextColor="TextColor.Muted">Current value: @_decimalValue</Small>
            </FieldBody>
        </Field>
        <Paragraph TextColor="TextColor.Muted" Margin="Margin.Is0">The NumericEdit component creates numeric input fields with built-in validation.</Paragraph>
    </DemoSection>

<Hr/>

<DemoSection Title="NumericEdit with Min/Max" Description="Min and Max constrain the value range." Code="@(@"<NumericEdit Id=""minMaxNumeric"" Min=""18"" Max=""100"" Placeholder=""Enter your age..."" @bind-Value=""_ageValue""/>
<NumericEdit Id=""positiveNumeric"" Min=""0"" Placeholder=""Positive only..."" @bind-Value=""_positiveValue""/>")">
    <Field>
        <FieldLabel For="minMaxNumeric">Age (18-100)</FieldLabel>
        <FieldBody>
            <NumericEdit Id="minMaxNumeric" Min="18" Max="100" Placeholder="Enter your age..." @bind-Value="_ageValue"/>
            <Small Class="form-text" TextColor="TextColor.Muted">Age: @_ageValue (Range: 18-100)</Small>
        </FieldBody>
    </Field>
    <Field>
        <FieldLabel For="positiveNumeric">Positive Number Only</FieldLabel>
        <FieldBody>
            <NumericEdit Id="positiveNumeric" Min="0" Placeholder="Enter positive number..." @bind-Value="_positiveValue"/>
            <Small Class="form-text" TextColor="TextColor.Muted">Value: @_positiveValue (Must be positive)</Small>
        </FieldBody>
    </Field>
</DemoSection>

<Hr/>

<DemoSection Title="NumericEdit with Step" Description="Step for increment/decrement." Code="@(@"<NumericEdit Id=""stepNumeric"" Step=""5"" Placeholder=""Increments of 5..."" @bind-Value=""_stepValue""/>
<NumericEdit Id=""decimalStepNumeric"" Step=""0.1m"" Placeholder=""Decimal increments..."" @bind-Value=""_decimalStepValue""/>")">
    <Div Margin="Margin.Is3.FromEnd" Class="space-y-4">
        <Field>
            <FieldLabel For="stepNumeric">Step by 5</FieldLabel>
            <FieldBody>
                <NumericEdit Id="stepNumeric" Step="5" Placeholder="Increments of 5..." @bind-Value="_stepValue"/>
                <Small Class="form-text" TextColor="TextColor.Muted">Value: @_stepValue (Step: 5)</Small>
            </FieldBody>
        </Field>
        <Field>
            <FieldLabel For="decimalStepNumeric">Decimal Step (0.1)</FieldLabel>
            <FieldBody>
                <NumericEdit Id="decimalStepNumeric" Step="0.1m" Placeholder="Decimal increments..." @bind-Value="_decimalStepValue"/>
                <Small Class="form-text" TextColor="TextColor.Muted">Value: @_decimalStepValue (Step: 0.1)</Small>
            </FieldBody>
        </Field>
    </Div>
</DemoSection>

<Hr/>

<DemoSection Title="NumericEdit with Validation" Description="Validations and Validation with NumericEdit." Code="@(@"<Validations Model=""_validationModel"">
    <Validation Action=""@ValidateRequired"">
        <NumericEdit Id=""requiredNumeric"" Placeholder=""Required"" @bind-Value=""_validationModel.RequiredNumber""/>
        <ValidationError/>
    </Validation>
</Validations>")">
    <Validations Model="_validationModel">
        <Div Margin="Margin.Is3.FromEnd" Class="space-y-4">
            <Field>
                <FieldLabel For="requiredNumeric" RequiredIndicator="true">Required Number</FieldLabel>
                <FieldBody>
                    <Validation Action="@ValidateRequired">
                        <NumericEdit Id="requiredNumeric" Placeholder="This field is required" @bind-Value="_validationModel.RequiredNumber"/>
                        <ValidationError/>
                    </Validation>
                </FieldBody>
            </Field>
            <Field>
                <FieldLabel For="rangeNumeric">Number in Range (1-100)</FieldLabel>
                <FieldBody>
                    <Validation Action="@ValidateRange">
                        <NumericEdit Id="rangeNumeric" Placeholder="Enter 1-100" @bind-Value="_validationModel.RangeNumber"/>
                        <ValidationError/>
                    </Validation>
                </FieldBody>
            </Field>
        </Div>
    </Validations>
</DemoSection>

<Hr/>

<DemoSection Title="NumericEdit with Different Sizes" Description="Size and Class for styling." Code="@(@"<NumericEdit Id=""smallNumeric"" Class=""form-control-sm"" @bind-Value=""_smallValue""/>
<NumericEdit Id=""largeNumeric"" Class=""form-control-lg"" @bind-Value=""_largeValue""/>")">
    <Div Margin="Margin.Is3.FromEnd" Class="space-y-4">
        <Field>
            <FieldLabel For="smallNumeric">Small NumericEdit</FieldLabel>
            <FieldBody>
                <NumericEdit Id="smallNumeric" Class="form-control-sm" Placeholder="Small input" @bind-Value="_smallValue"/>
            </FieldBody>
        </Field>
        <Field>
            <FieldLabel For="normalNumeric">Normal NumericEdit</FieldLabel>
            <FieldBody>
                <NumericEdit Id="normalNumeric" Placeholder="Normal input" @bind-Value="_normalValue"/>
            </FieldBody>
        </Field>
        <Field>
            <FieldLabel For="largeNumeric">Large NumericEdit</FieldLabel>
            <FieldBody>
                <NumericEdit Id="largeNumeric" Class="form-control-lg" Placeholder="Large input" @bind-Value="_largeValue"/>
            </FieldBody>
        </Field>
    </Div>
</DemoSection>

<Hr/>

<DemoSection Title="NumericEdit with Custom Styling" Description="Override styles with Style and Class.">
    <Div Margin="Margin.Is3.FromEnd">
        <Div Margin="Margin.Is3.FromBottom">
            <Label For="customNumeric" Form="true">Custom Styled NumericEdit</Label>
            <NumericEdit Id="customNumeric"
                         Class="custom-numeric"
                         Style="border: 2px solid #6f42c1; border-radius: 10px; padding: 10px; background-color: #f8f9fa;"
                         Placeholder="Custom styled numeric input"
                         @bind-Value="_customValue"/>
        </Div>
        <Div Margin="Margin.Is3.FromBottom">
            <Label For="gradientNumeric" Form="true">Gradient Border NumericEdit</Label>
            <NumericEdit Id="gradientNumeric"
                         Class="gradient-numeric"
                         Style="border: 2px solid transparent; background: linear-gradient(white, white) padding-box, linear-gradient(135deg, #667eea, #764ba2) border-box; border-radius: 8px;"
                         Placeholder="Gradient border numeric input"
                         @bind-Value="_gradientValue"/>
        </Div>
    </Div>
</DemoSection>

<Hr/>

<DemoSection Title="NumericEdit with Icons and Add-ons" Description="Input groups with icons and add-ons.">
    <Div Margin="Margin.Is3.FromEnd">
        <Div Margin="Margin.Is3.FromBottom">
            <Label For="iconNumeric" Form="true">NumericEdit with Icon</Label>
            <Div Class="input-group">
                <Span Class="input-group-text">
                    <Icon Name="calculator"/>
                </Span>
                <NumericEdit Id="iconNumeric" Placeholder="Enter number..." @bind-Value="_iconValue"/>
            </Div>
        </Div>
        <Div Margin="Margin.Is3.FromBottom">
            <Label For="currencyNumeric" Form="true">Currency Input</Label>
            <Div Class="input-group">
                <Span Class="input-group-text">$</Span>
                <NumericEdit Id="currencyNumeric" Placeholder="0.00" Step="0.01m" @bind-Value="_currencyValue"/>
                <Span Class="input-group-text">USD</Span>
            </Div>
        </Div>
    </Div>
</DemoSection>

<Hr/>

<DemoSection Title="NumericEdit Events" Description="Input, focus, and blur event handling.">
    <Div Margin="Margin.Is3.FromEnd">
        <Div Margin="Margin.Is3.FromBottom">
            <Label For="eventNumeric" Form="true">NumericEdit with Events</Label>
            <NumericEdit Id="eventNumeric"
                         Placeholder="Type here to see events"
                         @bind-Value="_eventValue"
                         @oninput="HandleInput"
                         @onfocus="HandleFocus"
                         @onblur="HandleBlur"/>
            <Small Class="form-text" TextColor="TextColor.Muted">
                Events: Input(@_inputCount), Focus(@_focusCount), Blur(@_blurCount)
            </Small>
        </Div>
    </Div>
</DemoSection>

<Hr/>

<DemoSection Title="NumericEdit Component Properties" Description="Properties inherited from Element base.">
    <Div BackgroundColor="BackgroundColor.Light" Padding="Padding.Is3" Margin="Margin.Is3.FromBottom">
        <H3>NumericEdit Features</H3>
        <Paragraph>The NumericEdit component inherits all properties from the Element base class plus:</Paragraph>
        <UnorderedList>
            <UnorderedListItem><Strong>Value:</Strong> Numeric value (decimal, int, long, etc.)</UnorderedListItem>
            <UnorderedListItem><Strong>Min:</Strong> Minimum allowed value</UnorderedListItem>
            <UnorderedListItem><Strong>Max:</Strong> Maximum allowed value</UnorderedListItem>
            <UnorderedListItem><Strong>Step:</Strong> Step increment value</UnorderedListItem>
            <UnorderedListItem><Strong>Placeholder:</Strong> Placeholder text</UnorderedListItem>
            <UnorderedListItem><Strong>ReadOnly:</Strong> Read-only state</UnorderedListItem>
            <UnorderedListItem><Strong>Disabled:</Strong> Disabled state</UnorderedListItem>
            <UnorderedListItem><Strong>Required:</Strong> Required validation</UnorderedListItem>
            <UnorderedListItem><Strong>AutoComplete:</Strong> Auto-complete behavior</UnorderedListItem>
            <UnorderedListItem><Strong>Event Handlers:</Strong> Input, focus, blur, change events</UnorderedListItem>
        </UnorderedList>
    </Div>
</DemoSection>

<Hr/>

<DemoSection Title="Accessibility Features" Description="ARIA attributes for screen readers.">
    <Div Margin="Margin.Is3.FromEnd">
        <Div Margin="Margin.Is3.FromBottom">
            <Label For="accessibleNumeric" Form="true">Accessible NumericEdit</Label>
            <NumericEdit Id="accessibleNumeric"
                         Placeholder="Accessible numeric input field"
                         AriaLabel="Enter a numeric value"
                         AriaDescribedBy="numeric-help"
                         @bind-Value="_accessibleValue"/>
            <Small Id="numeric-help" Class="form-text" TextColor="TextColor.Muted">This numeric input has proper ARIA attributes for accessibility.</Small>
        </Div>
    </Div>
</DemoSection>
    </Div>
</Div>

@code {

    // Binding Test Fields
    private decimal? _testNumeric1;
    private decimal? _testNumeric2 = 42.5m;

    private decimal? _basicValue = null;
    private decimal? _decimalValue = null;
    private decimal? _ageValue = null;
    private decimal? _positiveValue = null;
    private decimal? _stepValue = null;
    private decimal? _decimalStepValue = null;
    private decimal? _smallValue = null;
    private decimal? _normalValue = null;
    private decimal? _largeValue = null;
    private decimal? _customValue = null;
    private decimal? _gradientValue = null;
    private decimal? _iconValue = null;
    private decimal? _currencyValue = null;
    private decimal? _eventValue = null;
    private decimal? _accessibleValue = null;

    private int _inputCount = 0;
    private int _focusCount = 0;
    private int _blurCount = 0;

    private ValidationModel _validationModel = new();

    private void LoadNumericTestData()
    {
        _testNumeric1 = 123.45m;
        _testNumeric2 = 999.99m;
    }

    private void ClearNumericTestData()
    {
        _testNumeric1 = null;
        _testNumeric2 = null;
    }

    private void UpdateNumericTestData()
    {
        var random = new Random();
        _testNumeric1 = (decimal)(random.NextDouble() * 1000);
        _testNumeric2 = (decimal)(random.NextDouble() * 1000);
    }

    private void HandleInput(ChangeEventArgs e)
    {
        _inputCount++;
        StateHasChanged();
    }

    private void HandleFocus(FocusEventArgs e)
    {
        _focusCount++;
        StateHasChanged();
    }

    private void HandleBlur(FocusEventArgs e)
    {
        _blurCount++;
        StateHasChanged();
    }

    private void ValidateRequired(ValidatorEventArgs e)
    {
        if (e.Value == null || e.Value.ToString() == "0" || string.IsNullOrWhiteSpace(e.Value.ToString()))
        {
            e.Status = ValidationStatus.Error;
            e.ErrorText = "This field is required.";
        }
        else
        {
            e.Status = ValidationStatus.Success;
        }
    }

    private void ValidateRange(ValidatorEventArgs e)
    {
        if (e.Value == null)
        {
            e.Status = ValidationStatus.Error;
            e.ErrorText = "This field is required.";
            return;
        }

        if (decimal.TryParse(e.Value.ToString(), out decimal value))
        {
            if (value < 1 || value > 100)
            {
                e.Status = ValidationStatus.Error;
                e.ErrorText = "Value must be between 1 and 100.";
            }
            else
            {
                e.Status = ValidationStatus.Success;
            }
        }
        else
        {
            e.Status = ValidationStatus.Error;
            e.ErrorText = "Please enter a valid number.";
        }
    }

    public class ValidationModel
    {
        public decimal? RequiredNumber { get; set; } = null;
        public decimal? RangeNumber { get; set; } = null;
    }

    protected override void OnInitialized()
    {
    }

}
