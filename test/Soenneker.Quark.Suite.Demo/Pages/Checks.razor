@page "/checks"
@using Microsoft.Extensions.Logging

@inject ILogger<Index> Logger

<Container Class="py-4">
    <Row>
        <Column>
            <Div Class="text-center" Margin="Margin.Is5.FromEnd">
                <H1 Class="display-4 fw-bold text-primary">Checks</H1>
                <Paragraph Class="lead text-muted">This page demonstrates the Check component - a checkbox input wrapper.</Paragraph>
            </Div>
        </Column>
    </Row>
    
    <Row Gap="Gap.Is4">
        <Column>
            <Div>

<H2>Basic Checkbox</H2>
<Check @bind-Checked="isChecked1">
    Basic checkbox
</Check>
<Paragraph>Checked: @isChecked1</Paragraph>

<Br />

<H2>Checkbox with ChildContent (New)</H2>
<Check @bind-Checked="isChecked2">
    This checkbox has content inside it
</Check>
<Check @bind-Checked="isChecked3">
    Another checkbox with <Strong>bold text</Strong> inside
</Check>
<Paragraph>isChecked2: @isChecked2, isChecked3: @isChecked3</Paragraph>

<Br />

<H2>Different Sizes</H2>
<Check @bind-Checked="isChecked6" Size="@Size.ExtraSmall">
    Extra Small checkbox
</Check>
<Check @bind-Checked="isChecked7" Size="@Size.Small">
    Small checkbox
</Check>
<Check @bind-Checked="isChecked8" Size="@Size.Medium">
    Medium checkbox (default)
</Check>
<Check @bind-Checked="isChecked9" Size="@Size.Large">
    Large checkbox
</Check>
<Check @bind-Checked="isChecked10" Size="@Size.ExtraLarge">
    Extra Large checkbox
</Check>
<Check @bind-Checked="isChecked11" Size="@Size.ExtraExtraLarge">
    Extra Extra Large checkbox
</Check>

<Br />

<H2>Disabled Checkbox</H2>
<Check @bind-Checked="isChecked12" Disabled="true">
    Disabled checkbox
</Check>

<Br />

<H2>Indeterminate Checkbox</H2>
<Check @bind-Checked="isChecked13" Indeterminate="true">
    Indeterminate checkbox
</Check>

<Br />

<H2>Inline Checkboxes</H2>
<Check @bind-Checked="isChecked15" Inline="true">
    First inline
</Check>
<Check @bind-Checked="isChecked16" Inline="true">
    Second inline
</Check>
<Check @bind-Checked="isChecked17" Inline="true">
    Third inline
</Check>

<Br />

<H2>Event Handling</H2>
<Check @bind-Checked="isChecked14" OnChange="HandleChange">
    Checkbox with change event
</Check>
<Paragraph>Last change event: @lastChangeEvent</Paragraph>

<Br />

<H2>Validation</H2>
<Paragraph>This example requires the checkbox to be checked.</Paragraph>

<Validations @ref="validations" Model="@demoModel">
    <Validation Action="ValidateTerms">
        <Check @bind-Checked="demoModel.TermsAccepted">
            I accept the terms and conditions
        </Check>
        <ValidationError Class="mt-2" />
    </Validation>

    <Div Class="mt-2">
        <Button Class="btn btn-primary" OnClick="Submit">Submit</Button>
        <Span Class="ms-2">@submitResult</Span>
    </Div>
</Validations>
            </Div>
        </Column>
    </Row>
</Container>

@code{
    private bool isChecked1;
    private bool isChecked2;
    private bool isChecked3;
    private bool isChecked6; // Extra Small
    private bool isChecked7; // Small
    private bool isChecked8; // Medium
    private bool isChecked9; // Large
    private bool isChecked10; // Extra Large
    private bool isChecked11; // Extra Extra Large
    private bool isChecked12 = true; // Disabled
    private bool isChecked13; // Indeterminate
    private bool isChecked14; // Event handling
    private bool isChecked15; // Inline
    private bool isChecked16; // Inline
    private bool isChecked17; // Inline
    private string lastChangeEvent = "None";

    private Validations? validations;

    private class DemoModel
    {
        public bool TermsAccepted { get; set; }
    }

    private DemoModel demoModel = new();
    private string submitResult = string.Empty;

    protected override void OnInitialized()
    {
        Logger.LogInformation("Checks demo page initialized");
    }

    private void HandleChange(ChangeEventArgs args)
    {
        lastChangeEvent = $"Value: {args.Value}, Type: {args.Value?.GetType().Name}";
    }

    private void ValidateTerms(ValidatorEventArgs args)
    {
        var isChecked = args.Value is bool b ? b : demoModel.TermsAccepted;
        if (!isChecked)
        {
            args.Status = ValidationStatus.Error;
            args.ErrorText = "You must accept the terms.";
        }
        else
        {
            args.Status = ValidationStatus.Success;
        }
    }

    private async Task Submit()
    {
        if (validations is null)
            return;

        var ok = await validations.Validate();
        submitResult = ok ? "Submitted!" : "Please fix validation errors.";
    }
}
