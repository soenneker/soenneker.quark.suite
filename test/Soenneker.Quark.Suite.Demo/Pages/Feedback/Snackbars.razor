@page "/feedback/snackbars"

<PageTitle>Snackbars - Quark Suite</PageTitle>

<Div Class="space-y-8 max-w-4xl">
    <Div Class="space-y-6">
        <section class="space-y-4">
            <DemoSection Title="Basic snackbars" Description="Primary, success, warning, and danger; auto-dismiss." Code="@(@"<SnackbarStack @ref=""_snackbarStackRef""/>
<Button @onclick=""ShowBasicSnackbar"">Basic</Button>
// In code: await _snackbarStackRef.Push(""This is a basic snackbar message"", BackgroundColor.Primary);
// await _snackbarStackRef.Push(""Success!"", BackgroundColor.Success);
// await _snackbarStackRef.Push(""Warning"", BackgroundColor.Warning);
// await _snackbarStackRef.Push(""Error"", BackgroundColor.Danger);")">
                <Div Class="flex flex-wrap gap-2">
                    <Button Class="bg-primary text-primary-foreground" @onclick="ShowBasicSnackbar">Basic</Button>
                    <Button Class="bg-primary text-primary-foreground" @onclick="ShowSuccessSnackbar">Success</Button>
                    <Button Class="bg-primary text-primary-foreground" @onclick="ShowWarningSnackbar">Warning</Button>
                    <Button Class="bg-primary text-primary-foreground" @onclick="ShowErrorSnackbar">Error</Button>
                </Div>
            </DemoSection>
        </section>

        <section class="space-y-4">
            <DemoSection Title="With actions" Description="Snackbars with action or multi-action buttons." Code="@(@"await _snackbarStackRef.Push(""File uploaded successfully"", BackgroundColor.Success, options => {
    options.ShowAction = true;
    options.ActionText = ""View"";
});
// Multi-action: options.ShowAction = true; options.ActionText = ""Save""; options.ShowClose = true;")">
                <Div Class="flex flex-wrap gap-2">
                    <Button Class="bg-primary text-primary-foreground" @onclick="ShowActionSnackbar">With action</Button>
                    <Button Class="bg-secondary text-secondary-foreground" @onclick="ShowMultiActionSnackbar">Multi-action</Button>
                </Div>
            </DemoSection>
        </section>

        <section class="space-y-4">
            <DemoSection Title="Custom duration" Description="1s, 5s, or 10s auto-dismiss." Code="@(@"await _snackbarStackRef.Push(""Dismiss in 5s"", BackgroundColor.Info, options => {
    options.HideDelay = 5000; // milliseconds
});")">
                <Div Class="flex flex-wrap gap-2">
                    <Button Class="bg-primary text-primary-foreground" @onclick="() => ShowCustomDurationSnackbar(1000)">1 second</Button>
                    <Button Class="bg-primary text-primary-foreground" @onclick="() => ShowCustomDurationSnackbar(5000)">5 seconds</Button>
                    <Button Class="bg-primary text-primary-foreground" @onclick="() => ShowCustomDurationSnackbar(10000)">10 seconds</Button>
                </Div>
            </DemoSection>
        </section>

        <section class="space-y-4">
            <DemoSection Title="Persistent" Description="Requires manual dismissal." Code="@(@"await _snackbarStackRef.Push(""Requires manual dismissal"", BackgroundColor.Danger, options => {
    options.HideDelay = null; // Never auto-hide
    options.ShowClose = true;
    options.CloseText = ""Dismiss"";
});")">
                <Button Class="bg-primary text-primary-foreground" @onclick="ShowPersistentSnackbar">Show persistent snackbar</Button>
            </DemoSection>
        </section>

        <section class="space-y-4">
            <DemoSection Title="Custom styling" Description="Custom and gradient styled snackbars." Code="@(@"await _snackbarStackRef.Push(""Custom styled snackbar"", BackgroundColor.Info);
await _snackbarStackRef.Push(""Gradient styled"", BackgroundColor.Primary);")">
                <Div Class="flex flex-wrap gap-2">
                    <Button Class="bg-primary text-primary-foreground" @onclick="ShowCustomStyledSnackbar">Custom styled</Button>
                    <Button Class="bg-primary text-primary-foreground" @onclick="ShowGradientSnackbar">Gradient</Button>
                </Div>
            </DemoSection>
        </section>

        <section class="space-y-4">
            <DemoSection Title="Stack" Description="Add multiple snackbars; clear stack." Code="@(@"await _snackbarStackRef.Push(""First"", BackgroundColor.Primary);
await _snackbarStackRef.Push(""Second"", BackgroundColor.Success);
await _snackbarStackRef.Push(""Third"", BackgroundColor.Warning);")">
                <Div Class="flex flex-wrap gap-2">
                    <Button Class="bg-primary text-primary-foreground" @onclick="AddToStack">Add to stack</Button>
                    <Button Class="bg-secondary text-secondary-foreground" @onclick="ClearStack">Clear stack</Button>
                </Div>
            </DemoSection>
        </section>

        <section class="space-y-4">
            <DemoSection Title="Positions" Description="Top/bottom, left/center/right." Code="@(@"await _snackbarStackRef.Push(""Top Left"", ..., location: SnackbarLocation.TopStart);
// Top, TopEnd, BottomStart, Bottom, BottomEnd")">
                <Div Class="grid grid-cols-2 gap-2 max-w-md">
                    <Button Class="bg-primary text-primary-foreground" @onclick="@(() => ShowPositionedSnackbar("top-left"))" Size="ButtonSize.Sm">Top Left</Button>
                    <Button Class="bg-primary text-primary-foreground" @onclick="@(() => ShowPositionedSnackbar("top-center"))" Size="ButtonSize.Sm">Top Center</Button>
                    <Button Class="bg-primary text-primary-foreground" @onclick="@(() => ShowPositionedSnackbar("top-right"))" Size="ButtonSize.Sm">Top Right</Button>
                    <Button Class="bg-primary text-primary-foreground" @onclick="@(() => ShowPositionedSnackbar("bottom-left"))" Size="ButtonSize.Sm">Bottom Left</Button>
                    <Button Class="bg-primary text-primary-foreground" @onclick="@(() => ShowPositionedSnackbar("bottom-center"))" Size="ButtonSize.Sm">Bottom Center</Button>
                    <Button Class="bg-primary text-primary-foreground" @onclick="@(() => ShowPositionedSnackbar("bottom-right"))" Size="ButtonSize.Sm">Bottom Right</Button>
                </Div>
            </DemoSection>
        </section>

        <section class="space-y-4">
            <DemoSection Title="Location override" Description="Override default position; show at multiple locations." Code="@(@"Push(..., location: SnackbarLocation.TopEnd);
// Override default stack location per call")">
                <Div Class="flex flex-wrap gap-2">
                    <Button Class="bg-primary text-primary-foreground" @onclick="ShowLocationOverrideSnackbar">Location override</Button>
                    <Button Class="bg-primary text-primary-foreground" @onclick="ShowMultipleLocationSnackbars">Multiple locations</Button>
                </Div>
            </DemoSection>
        </section>

        <section class="space-y-4">
            <DemoSection Title="Rich content" Description="Icons, formatted text, multiple lines." Code="@(@"await _snackbarStackRef.Push with custom content / RenderFragment
for icons, formatted text, multiple lines")">
                <Button Class="bg-primary text-primary-foreground" @onclick="ShowRichContentSnackbar">Rich content snackbar</Button>
            </DemoSection>
        </section>

        <section class="space-y-4">
            <DemoSection Title="Snackbar features" Description="Overview of components and options." Code="@(@"SnackbarStack: container for multiple snackbars
Auto-dismiss: configurable HideDelay (ms)
Positioning: TopStart, Top, TopEnd, BottomStart, Bottom, BottomEnd
Actions: ShowAction, ActionText, ShowClose, CloseText")">
                <Div Class="rounded-lg border border-border bg-muted/50 p-4">
                    <Paragraph Class="text-lg font-semibold">Snackbar Features</Paragraph>
                    <Paragraph Margin="Margin.Is0">Snackbar components provide notification functionality:</Paragraph>
                    <UnorderedList>
                        <UnorderedListItem><Strong>SnackbarStack:</Strong> Container for multiple snackbars</UnorderedListItem>
                        <UnorderedListItem><Strong>Auto-dismiss:</Strong> Configurable timing</UnorderedListItem>
                        <UnorderedListItem><Strong>Positioning:</Strong> Top/bottom, start/center/end</UnorderedListItem>
                        <UnorderedListItem><Strong>Actions:</Strong> Buttons and close</UnorderedListItem>
                    </UnorderedList>
                </Div>
            </DemoSection>
        </section>

        <section class="space-y-4">
            <DemoSection Title="Theme configuration" Description="Uses theme default location and delay." Code="@(@"SnackbarStack uses theme defaults for location and HideDelay
When not overridden per Push() call")">
                <Button Class="bg-primary text-primary-foreground" @onclick="ShowThemeConfiguredSnackbar">Theme-configured snackbar</Button>
            </DemoSection>
        </section>

        <section class="space-y-4">
            <DemoSection Title="Accessibility" Description="ARIA attributes and keyboard support." Code="@(@"Snackbars expose ARIA live region and role=""status""
Keyboard: Escape to dismiss When focusable")">
                <Button Class="bg-primary text-primary-foreground" @onclick="ShowAccessibleSnackbar">Accessible snackbar</Button>
            </DemoSection>
        </section>
    </Div>
</Div>

<!-- Snackbar Stack Container -->
<SnackbarStack @ref="_snackbarStackRef" />

@code {
    private SnackbarStack? _snackbarStackRef;

    private async Task ShowBasicSnackbar()
    {
        if (_snackbarStackRef != null)
            await _snackbarStackRef.Push("This is a basic snackbar message", BackgroundColor.Primary);
    }

    private async Task ShowSuccessSnackbar()
    {
        if (_snackbarStackRef != null)
            await _snackbarStackRef.Push("Operation completed successfully!", BackgroundColor.Success);
    }

    private async Task ShowWarningSnackbar()
    {
        if (_snackbarStackRef != null)
            await _snackbarStackRef.Push("Warning: Please review your input", BackgroundColor.Warning);
    }

    private async Task ShowErrorSnackbar()
    {
        if (_snackbarStackRef != null)
            await _snackbarStackRef.Push("Error: Something went wrong", BackgroundColor.Danger);
    }

    private async Task ShowActionSnackbar()
    {
        if (_snackbarStackRef != null)
            await _snackbarStackRef.Push("File uploaded successfully", BackgroundColor.Success, options =>
            {
                options.ShowAction = true;
                options.ActionText = "View";
            });
    }

    private async Task ShowMultiActionSnackbar()
    {
        if (_snackbarStackRef != null)
            await _snackbarStackRef.Push("Changes not saved", BackgroundColor.Warning, options =>
            {
                options.ShowAction = true;
                options.ActionText = "Save";
                options.ShowClose = true;
            });
    }

    private async Task ShowCustomDurationSnackbar(int duration)
    {
        if (_snackbarStackRef != null)
            await _snackbarStackRef.Push($"This snackbar will dismiss in {duration / 1000} seconds", BackgroundColor.Info, options =>
            {
                options.HideDelay = duration;
            });
    }

    private async Task ShowPersistentSnackbar()
    {
        if (_snackbarStackRef != null)
            await _snackbarStackRef.Push("This snackbar requires manual dismissal", BackgroundColor.Danger, options =>
            {
                options.HideDelay = null; // Never auto-hide
                options.ShowClose = true;
                options.CloseText = "Dismiss";
            });
    }

    private async Task ShowCustomStyledSnackbar()
    {
        if (_snackbarStackRef != null)
            await _snackbarStackRef.Push("Custom styled snackbar with unique appearance", BackgroundColor.Info);
    }

    private async Task ShowGradientSnackbar()
    {
        if (_snackbarStackRef != null)
            await _snackbarStackRef.Push("Gradient styled snackbar", BackgroundColor.Primary);
    }

    private async Task AddToStack()
    {
        if (_snackbarStackRef != null)
        {
            await _snackbarStackRef.Push("First snackbar in stack", BackgroundColor.Primary);
            await Task.Delay(500);
            await _snackbarStackRef.Push("Second snackbar in stack", BackgroundColor.Success);
            await Task.Delay(500);
            await _snackbarStackRef.Push("Third snackbar in stack", BackgroundColor.Warning);
            await Task.Delay(500);
            await _snackbarStackRef.Push("Fourth snackbar in stack", BackgroundColor.Info);
        }
    }

    private async Task ClearStack()
    {
        // Clear functionality would need to be implemented in the SnackbarStack
        // For now, we'll just show a message
        if (_snackbarStackRef != null)
            await _snackbarStackRef.Push("Stack cleared", BackgroundColor.Secondary);
    }

    private async Task ShowPositionedSnackbar(string position)
    {
        if (_snackbarStackRef != null)
        {
            var location = position switch
            {
                "top-left" => SnackbarLocation.TopStart,
                "top-center" => SnackbarLocation.Top,
                "top-right" => SnackbarLocation.TopEnd,
                "bottom-left" => SnackbarLocation.BottomStart,
                "bottom-center" => SnackbarLocation.Bottom,
                "bottom-right" => SnackbarLocation.BottomEnd,
                _ => SnackbarLocation.BottomEnd
            };
            
            await _snackbarStackRef.Push($"Snackbar positioned at {position}", BackgroundColor.Primary, location: location);
        }
    }

    private async Task ShowRichContentSnackbar()
    {
        if (_snackbarStackRef != null)
        {
            var richContent = new RenderFragment(builder =>
            {
                builder.OpenElement(0, "div");
                builder.AddContent(1, "Email: ");
                builder.OpenElement(2, "strong");
                builder.AddContent(3, "New Message");
                builder.CloseElement();
                builder.AddMarkupContent(4, "<br/>");
                builder.AddContent(5, "You have received a new message from John Doe");
                builder.CloseElement();
            });

            await _snackbarStackRef.Push(richContent, BackgroundColor.Info, options =>
            {
                options.ShowAction = true;
                options.ActionText = "View";
            });
        }
    }

    private async Task ShowAccessibleSnackbar()
    {
        if (_snackbarStackRef != null)
            await _snackbarStackRef.Push("This snackbar has proper accessibility features", BackgroundColor.Primary);
    }

    private async Task ShowLocationOverrideSnackbar()
    {
        if (_snackbarStackRef != null)
            await _snackbarStackRef.Push("This snackbar uses the location parameter to override the default position", BackgroundColor.Info, location: SnackbarLocation.Top);
    }

    private async Task ShowMultipleLocationSnackbars()
    {
        if (_snackbarStackRef != null)
        {
            await _snackbarStackRef.Push("Top-left snackbar", BackgroundColor.Primary, location: SnackbarLocation.TopStart);
            await Task.Delay(200);
            await _snackbarStackRef.Push("Top-center snackbar", BackgroundColor.Secondary, location: SnackbarLocation.Top);
            await Task.Delay(200);
            await _snackbarStackRef.Push("Top-right snackbar", BackgroundColor.Success, location: SnackbarLocation.TopEnd);
            await Task.Delay(200);
            await _snackbarStackRef.Push("Bottom-left snackbar", BackgroundColor.Warning, location: SnackbarLocation.BottomStart);
            await Task.Delay(200);
            await _snackbarStackRef.Push("Bottom-center snackbar", BackgroundColor.Info, location: SnackbarLocation.Bottom);
            await Task.Delay(200);
            await _snackbarStackRef.Push("Bottom-right snackbar", BackgroundColor.Danger, location: SnackbarLocation.BottomEnd);
        }
    }

    // Action handlers
    private async Task HandleViewAction()
    {
        if (_snackbarStackRef != null)
            await _snackbarStackRef.Push("View action clicked!", BackgroundColor.Success);
    }

    private async Task HandleSaveAction()
    {
        if (_snackbarStackRef != null)
            await _snackbarStackRef.Push("Changes saved successfully!", BackgroundColor.Success);
    }

    private async Task HandleDiscardAction()
    {
        if (_snackbarStackRef != null)
            await _snackbarStackRef.Push("Changes discarded", BackgroundColor.Warning);
    }

    private async Task HandleDismissAction()
    {
        if (_snackbarStackRef != null)
            await _snackbarStackRef.Push("Snackbar dismissed", BackgroundColor.Info);
    }

    private async Task HandleMarkReadAction()
    {
        if (_snackbarStackRef != null)
            await _snackbarStackRef.Push("Message marked as read", BackgroundColor.Success);
    }

    private async Task ShowThemeConfiguredSnackbar()
    {
        if (_snackbarStackRef != null)
            await _snackbarStackRef.Push("This snackbar uses theme-configured defaults (no explicit location or delay)", BackgroundColor.Info);
    }

    protected override void OnInitialized()
    {
    }
}
