@page "/overlays/collapses"

<PageTitle>Collapses - Quark Suite</PageTitle>

<Div Class="space-y-8 max-w-4xl">
    <Div Class="space-y-3">
        <H1 Class="text-4xl font-bold tracking-tight">Collapses</H1>
        <Paragraph Class="text-xl text-muted-foreground" Margin="Margin.Is0">
            Toggle the visibility of content with smooth animations.
        </Paragraph>
    </Div>

    <Section Class="space-y-6">
        <DemoSection Title="Basic" Code="@(@"<Button CollapseTarget=""basicCollapse"">Toggle</Button>
<Collapse Id=""basicCollapse"">
    <Card><CardBody><Paragraph>Content...</Paragraph></CardBody></Card>
</Collapse>")">
            <Div Class="space-y-2">
                <Button BackgroundColor="BackgroundColor.Primary" CollapseTarget="basicCollapse">Toggle Collapse</Button>
                <Collapse Id="basicCollapse">
                    <Card>
                        <CardBody>
                            <Paragraph>Collapsible content. Can include text, images, forms, or other components.</Paragraph>
                        </CardBody>
                    </Card>
                </Collapse>
            </Div>
        </DemoSection>
    </Section>

    <Section Class="space-y-6">
        <H2 Class="text-2xl font-semibold tracking-tight">Multiple Targets</H2>
        <DemoSection>
            <Div Class="flex flex-wrap gap-2 mb-4">
                <Button BackgroundColor="BackgroundColor.Primary" CollapseTarget="firstCollapse">First</Button>
                <Button BackgroundColor="BackgroundColor.Secondary" CollapseTarget="secondCollapse">Second</Button>
                <Button BackgroundColor="BackgroundColor.Success" Attributes="@(new Dictionary<string, object> { { "data-bs-toggle", "collapse" }, { "data-bs-target", ".multi-collapse" }, { "aria-controls", "firstCollapse secondCollapse" } })">Both</Button>
            </Div>
            <Div Class="grid gap-4 md:grid-cols-2">
                <Collapse Class="multi-collapse" Id="firstCollapse">
                    <Card><CardBody><Paragraph>First collapsible element.</Paragraph></CardBody></Card>
                </Collapse>
                <Collapse Class="multi-collapse" Id="secondCollapse">
                    <Card><CardBody><Paragraph>Second collapsible element.</Paragraph></CardBody></Card>
                </Collapse>
            </Div>
        </DemoSection>
    </Section>

    <Section Class="space-y-6">
        <H2 Class="text-2xl font-semibold tracking-tight">Horizontal</H2>
        <DemoSection>
            <Div Class="space-y-2">
                <Button BackgroundColor="BackgroundColor.Primary" CollapseTarget="horizontalCollapse">Toggle Horizontal</Button>
                <Div Class="flex">
                    <Collapse Id="horizontalCollapse" Horizontal="true">
                        <Card Class="w-[300px]">
                            <CardBody>
                                <Paragraph>Horizontal collapse animates width instead of height.</Paragraph>
                            </CardBody>
                        </Card>
                    </Collapse>
                </Div>
            </Div>
        </DemoSection>
    </Section>

    <Section Class="space-y-6">
        <H2 Class="text-2xl font-semibold tracking-tight">Form in Collapse</H2>
        <DemoSection>
            <Div Class="space-y-2">
                <Button BackgroundColor="BackgroundColor.Info" CollapseTarget="formCollapse">Toggle Form</Button>
                <Collapse Id="formCollapse">
                    <Card>
                        <CardHeader><Strong>Contact Form</Strong></CardHeader>
                        <CardBody>
                            <Field><FieldLabel>Name</FieldLabel><FieldBody><TextEdit @bind-Value="_formName" Placeholder="Name"/></FieldBody></Field>
                            <Field><FieldLabel>Email</FieldLabel><FieldBody><TextEdit @bind-Value="_formEmail" Placeholder="Email"/></FieldBody></Field>
                            <Field><FieldLabel>Message</FieldLabel><FieldBody><MemoEdit @bind-Value="_formMessage" Placeholder="Message" Rows="3"/></FieldBody></Field>
                            <Div Class="flex gap-2 mt-4">
                                <Button BackgroundColor="BackgroundColor.Success" OnClick="SubmitForm">Submit</Button>
                                <Button BackgroundColor="BackgroundColor.Secondary" OnClick="ResetForm">Reset</Button>
                            </Div>
                        </CardBody>
                    </Card>
                </Collapse>
            </Div>
        </DemoSection>
    </Section>

    <Section Class="space-y-6">
        <H2 Class="text-2xl font-semibold tracking-tight">Programmatic Control</H2>
        <DemoSection Description="@($"State: {(_programmaticCollapseExpanded ? "Expanded" : "Collapsed")}")">
            <Div Class="flex gap-2 mb-4">
                <Button BackgroundColor="BackgroundColor.Primary" OnClick="ShowProgrammaticCollapse">Show</Button>
                <Button BackgroundColor="BackgroundColor.Secondary" OnClick="HideProgrammaticCollapse">Hide</Button>
                <Button BackgroundColor="BackgroundColor.Info" OnClick="ToggleProgrammaticCollapse">Toggle</Button>
            </Div>
            <Collapse @ref="_programmaticCollapse" Expanded="@_programmaticCollapseExpanded">
                <Card>
                    <CardBody>
                        <Paragraph>Controlled programmatically via Show, Hide, Toggle.</Paragraph>
                    </CardBody>
                </Card>
            </Collapse>
        </DemoSection>
    </Section>
</Div>

@code {
    private Collapse? _programmaticCollapse;
    private bool _programmaticCollapseExpanded;
    private string _formName = "";
    private string _formEmail = "";
    private string _formMessage = "";

    private async Task ShowProgrammaticCollapse() { if (_programmaticCollapse != null) { await _programmaticCollapse.Show(); _programmaticCollapseExpanded = true; StateHasChanged(); } }
    private async Task HideProgrammaticCollapse() { if (_programmaticCollapse != null) { await _programmaticCollapse.Hide(); _programmaticCollapseExpanded = false; StateHasChanged(); } }
    private async Task ToggleProgrammaticCollapse() { if (_programmaticCollapse != null) { await _programmaticCollapse.Toggle(); _programmaticCollapseExpanded = !_programmaticCollapseExpanded; StateHasChanged(); } }

    private async Task SubmitForm() { await Task.Delay(500); _formName = ""; _formEmail = ""; _formMessage = ""; StateHasChanged(); }
    private void ResetForm() { _formName = ""; _formEmail = ""; _formMessage = ""; StateHasChanged(); }
}
