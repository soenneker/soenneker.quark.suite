@page "/media/images"
@using Microsoft.Extensions.Logging
@using Soenneker.Extensions.String

@inject ILogger<Index> Logger

<PageTitle>Images - Quark Suite</PageTitle>

<Div Class="space-y-8 max-w-4xl">
    <Div Class="space-y-6">
        <section class="space-y-4">
            <DemoSection Title="Basic" Description="Default styling." Code="@(@"<Image Source=""https://picsum.photos/300/200"" Alt=""Random image""/>")">
                <Image Source="https://picsum.photos/300/200" Alt="Random image"/>
            </DemoSection>
        </section>

        <section class="space-y-4">
            <DemoSection Title="Fluid" Description="Full width of container." Code="@(@"<Image Source=""..."" Alt=""Fluid image"" Fluid=""true""/>")">
                <Paragraph>Image that takes up the full width of its container:</Paragraph>
                <Div MaxWidth="@("500px")">
                    <Image Source="https://picsum.photos/800/400" Alt="Fluid image" Fluid="true"/>
                </Div>
            </DemoSection>
        </section>

        <section class="space-y-4">
            <DemoSection Title="Lazy loading" Description="Loading=lazy attribute." Code="@(@"<Image Source=""..."" Alt=""Lazy"" Lazy=""true""/>")">
                <Image Source="https://picsum.photos/400/300" Alt="Lazy loaded image" Lazy="true"/>
            </DemoSection>
        </section>

        <section class="space-y-4">
            <DemoSection Title="Custom dimensions" Description="Width and height." Code="@(@"<Image Source=""..."" Alt=""Custom"" Width=""250"" Height=""150""/>")">
                <Image Source="https://picsum.photos/250/150" Alt="Custom sized image" Width="250" Height="150"/>
            </DemoSection>
        </section>

        <section class="space-y-4">
            <DemoSection Title="Responsive" Description="SrcSet and Sizes." Code="@(@"<Image Source=""..."" Alt=""Responsive"" SrcSet=""... 200w, ... 400w"" Sizes=""(max-width: 600px) 200px, 400px""/>")">
                <Image Source="https://picsum.photos/400/300"
                       Alt="Responsive image"
                       SrcSet="https://picsum.photos/200/150 200w, https://picsum.photos/400/300 400w, https://picsum.photos/800/600 800w"
                       Sizes="(max-width: 600px) 200px, (max-width: 1200px) 400px, 800px"/>
            </DemoSection>
        </section>

        <section class="space-y-4">
            <DemoSection Title="Custom classes" Description="Rounded, shadow." Code="@(@"<Image Source=""..."" Alt=""Styled"" Class=""rounded shadow""/>")">
                <Image Source="https://picsum.photos/300/200"
                       Alt="Custom styled image"
                       Class="rounded shadow"/>
            </DemoSection>
        </section>

        <section class="space-y-4">
            <DemoSection Title="Event handlers" Description="OnLoad, OnError.">
                <Image Source="https://picsum.photos/300/200"
                       Alt="Image with events"
                       OnLoad="OnImageLoad"
                       OnError="OnImageError"/>
                @if (_loadMessage.HasContent())
                {
                    <Alert Class="border-border mt-2" BackgroundColor="BackgroundColor.Success">@_loadMessage</Alert>
                }
                @if (_errorMessage.HasContent())
                {
                    <Alert Class="border-border mt-2" BackgroundColor="BackgroundColor.Danger">@_errorMessage</Alert>
                }
            </DemoSection>
        </section>

        <section class="space-y-4">
            <DemoSection Title="Gallery" Description="Responsive grid of images.">
                <Row>
                    @for (var i = 1; i <= 6; i++)
                    {
                        var imageSource = $"https://picsum.photos/300/200?random={i}";
                        var imageAlt = $"Gallery image {i}";
                        <Column ColumnSize="@ColumnSize.Is4.OnMd" Margin="Margin.Is3.FromEnd">
                            <Image Source="@imageSource"
                                   Alt="@imageAlt"
                                   Class="img-fluid rounded"/>
                        </Column>
                    }
                </Row>
            </DemoSection>
        </section>
    </Div>
</Div>

@code {
    private string? _loadMessage;
    private string? _errorMessage;

    protected override void OnInitialized()
    {
        Logger.LogInformation("Image demo page initialized");
    }

    private void OnImageLoad(ProgressEventArgs args)
    {
        _loadMessage = "Image loaded successfully!";
        _errorMessage = null;
        StateHasChanged();
    }

    private void OnImageError(ErrorEventArgs args)
    {
        _errorMessage = "Failed to load image!";
        _loadMessage = null;
        StateHasChanged();
    }
}
