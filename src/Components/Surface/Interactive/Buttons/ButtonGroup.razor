@using Soenneker.Quark.Components.Surface.Interactive.Buttons.Abstract

@namespace Soenneker.Quark
@inherits Soenneker.Quark.Element
@implements IButtonGroup

<CascadingValue Value="this">
    <div @attributes="BuildAttributes()">
        @ChildContent
    </div>
</CascadingValue>

@code {
    [Parameter]
    public CssValue<SizeBuilder>? Size { get; set; }

    [Parameter]
    public bool Vertical { get; set; }

    [Parameter]
    public string? Role { get; set; }

    [Parameter]
    public string? AriaLabel { get; set; }

    protected override void BuildAttributesCore(Dictionary<string, object> attributes)
    {
        base.BuildAttributesCore(attributes);

        BuildClassAttribute(attributes, (ref cls) =>
        {
            AppendClass(ref cls, "q-button-group");
            var groupClass = Vertical ? "btn-group-vertical" : "btn-group";
            AppendClass(ref cls, groupClass);
            
            if (Size != null && Size != Quark.Size.Default)
            {
                var sizeValue = Size.ToString();
                if (sizeValue.HasContent())
                {
                    AppendClass(ref cls, $"btn-group-{sizeValue}");
                }
            }
        });

        // Set default role if not specified
        if (!attributes.ContainsKey("role"))
        {
            attributes["role"] = Role ?? "group";
        }

        // Set aria-label if specified
        if (AriaLabel.HasContent())
        {
            attributes["aria-label"] = AriaLabel;
        }
    }

    protected override void ComputeRenderKeyCore(ref HashCode hc)
    {
        AddIf(ref hc, Size);
        hc.Add(Vertical);
        hc.Add(Role);
        hc.Add(AriaLabel);
    }
}